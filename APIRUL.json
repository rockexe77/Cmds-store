{
  "api": "const mongoose = require("mongoose");
const fs = require("fs");

const uri = "mongodb+srv://rockx27:rockonx27fire@cluster0.e5kr5.mongodb.net/GoatBotV2?retryWrites=true&w=majority&appName=Cluster0"; 
mongoose.connect(uri, { useNewUrlParser: true, useUnifiedTopology: true });

const emojis = [
  "ğŸ˜", "ğŸ˜„", "ğŸ˜", "ğŸ˜Š", "ğŸ˜‰", "ğŸ˜œ", "ğŸ™ƒ", "ğŸ¥³", "ğŸ’–", "ğŸ’¥", 
  "ğŸ’™", "ğŸ’š", "ğŸ’›", "ğŸ’œ", "â¤ï¸", "ğŸ’—", "ğŸ’˜", "ğŸ’", "ğŸ§¡", "ğŸ–¤", 
  "ğŸ¤©", "ğŸ¥°", "ğŸ˜‡", "ğŸ˜»", "ğŸ’Œ", "ğŸŒŸ", "ğŸ”¥", "ğŸ«¶ğŸ»", "ğŸ˜™", "ğŸ˜š", 
  "ğŸ™‚", "ğŸ¥¹", "ğŸ˜¡", "ğŸ˜º", "ğŸ˜¼", "ğŸ˜½", "ğŸ˜¸", "ğŸ˜", "ğŸ˜‹", "ğŸ˜›", 
  "ğŸ˜’", "ğŸ˜", "ğŸ˜¦", "ğŸ˜³", "ğŸ™ˆ", "ğŸ™‰", "ğŸ™Š", "ğŸ™€", "ğŸ’", "ğŸ¤", 
  "ğŸ¥", "ğŸ£", "ğŸ¸", "ğŸ¦‹", "ğŸŒ¸"
];

const TeachSchema = new mongoose.Schema({
  trigger: String,
  responses: [String]
});
const Teach = mongoose.models.Teach || mongoose.model("Teach", TeachSchema);

const fontData = JSON.parse(fs.readFileSync("style.json", "utf-8"));
const fontStyle = fontData["3"];

function applyFontStyle(text, fontStyle) {
  return text.split('').map(char => fontStyle[char] || char).join('');
}

const stringSimilarity = require("string-similarity");

async function getBotResponse(input) {
  try {
    const allData = await Teach.find();
    const triggers = allData.map(item => item.trigger.toLowerCase());

    const normalizedInput = input.toLowerCase();
    const matchingTriggers = triggers.filter(trigger =>
      trigger.includes(normalizedInput) || normalizedInput.includes(trigger)
    );

    const matches = stringSimilarity.findBestMatch(normalizedInput, triggers);
    const bestMatch = matches.bestMatch.rating > 0.6 ? matches.bestMatch.target : null;
    const finalMatch = bestMatch || matchingTriggers[0];

    if (finalMatch) {
      const matchedData = allData.find(item => item.trigger.toLowerCase() === finalMatch);
      if (matchedData && matchedData.responses.length > 0) {
        const randomIndex = Math.floor(Math.random() * matchedData.responses.length);
        const randomEmoji = emojis[Math.floor(Math.random() * emojis.length)];
        const styledResponse = applyFontStyle(matchedData.responses[randomIndex], fontStyle);

        return `${styledResponse} ${randomEmoji}`;
      }
    }

    return applyFontStyle("ğ¨ğ¢ ğ¦ğšğ¦ğš ğğ¢ğ­ğš ğšğ¦ğ¤ ğ­ğğšğœğ¡ ğ¤ğ¨ğ«ğš ğ¡ğ² ğ§ğšğ¢ <ğŸ¥º", fontStyle);
  } catch (error) {
    console.error("MongoDB à¦¥à§‡à¦•à§‡ à¦¡à¦¾à¦Ÿà¦¾ à¦¨à¦¿à§Ÿà§‡ à¦†à¦¸à¦¾à¦° à¦¸à¦®à§Ÿ à¦¤à§à¦°à§à¦Ÿà¦¿:", error.message);
    return applyFontStyle("à¦¤à§à¦°à§à¦Ÿà¦¿ à¦˜à¦Ÿà§‡à¦›à§‡à¥¤", fontStyle);
  }
      }"
}
